# Linview OSS Helm Chart

metricbeat: {}
kibana:
  resources:
    requests:
      cpu: "1400m"
      memory: "2Gi"
    limits:
      cpu: "2000m"
      memory: "4Gi"
  ingress:
    enabled: true
    annotations: {}
    path: /
    hosts:
      - test.example.com
  kibanaConfig:
    kibana.yml: |
      elasticsearch.hosts: [ "http://elasticsearch-master:9200" ]
      elasticsearch.username: elastic
      elasticsearch.password: test123
      monitoring.enabled: false
  secretMounts:
  - name: import-json-secret
    secretName: import-json-secret
    path: /etc/import.json
    subPath: import.json 
  lifecycle:
    postStart:
      exec:
        command: ["bash", "-c", "sleep 120s; echo 'DOING'; curl -XPOST 'http://localhost:5601/api/kibana/dashboards/import' -H 'Content-Type: application/json' -H 'kbn-xsrf: true' -d @/etc/import.json"]
 # lifecycle:
 #   postStart:
 ##     exec:
  #      command: 
   #       - bash
    #      - -c
     #     - |
      ###    KB_URL=http://localhost:5601
         #   while [[ "$(curl -s -o /dev/null -w '%{http_code}\n' -L $KB_URL)" != "200" ]]; do sleep 1; done
          #  curl -XPOST "$KB_URL/api/kibana/dashboards/import" -H "Content-Type: application/json" -H 'kbn-xsrf: true' -d @/etc/import.json

elasticsearch:
  esJavaOpts: "-Xmx2g -Xms2g"
  antiAffinity: "soft"
  enableServiceLinks: false
  resources:
    requests:
      cpu: "1400m"
      memory: "2Gi"
    limits:
      cpu: "2000m"
      memory: "6Gi"
  #esConfig: 
  #  elasticsearch.yml: |
  #    xpack.license.self_generated.type: trial
  #    xpack.security.enabled: true
  #    xpack.monitoring.collection.enabled: true

ingress:
  enabled: false
  annotations:
    {}
  hosts:
    - host: chart-example.local
      paths: []
  tls: []
